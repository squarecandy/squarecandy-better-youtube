!function(t){if(t(document).ready((function(){fitvids(".fitvids"),t(document).on("click",".uc-embedding-accept",(function(){setTimeout((function(){fitvids(".fitvids")}),1e3)})),t(".custom-playlist").each((function(){t(this).magnificPopup({delegate:".playlist-list ul li a",type:"iframe",iframe:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe id="player" class="mfp-iframe" frameborder="0" allowfullscreen></iframe><div class="mfp-bottom-bar"><div class="mfp-title">...</div></div></div>',patterns:{youtube:{index:"youtube.com",id:null,src:"%id%"}}},gallery:{enabled:!0},callbacks:{updateStatus(){const i=t(this)[0].currItem.el[0].title;setTimeout((function(){t(".mfp-title").html(i)}),200)}}})})),t(".api-playlist-anchor").each((function(){t(this).magnificPopup({type:"inline",callbacks:{open(){window.players[this.content.data("post-id")]&&window.players[this.content.data("post-id")].init()},close(){console.log(this.content.data("post-id"),window.players[this.content.data("post-id")]),window.players[this.content.data("post-id")]&&window.players[this.content.data("post-id")].close()}}})})),t(".playlist-preview-first a").on("click",(function(i){i.preventDefault(),t(this).parent().next().find("ul li:first-child a").click()}))})),t(".custom-api-playlist").length){class i{playerId;playlistId;player;videoIframe;videoContainer;previews;thumbnails;videoList=[];navButtons;previousButton;nextButton;autoplay=!1;autoload=!0;popup=!1;debug=!1;isActivePlayer=!1;startVideo=0;inactiveButtonClass="hidden";postId;instantiated=!1;actionsBound=!1;loop=!0;singleVideo=!1;singleVideoUrl="";singleVideoTitle="";constructor(i,{autoplay:e=!1,autoload:s=!0,debug:a=!1,popup:o=!1,loop:n=!0,layout:l="single-popup"}){this.videoContainer=t(i),this.playlistId=this.videoContainer.data("playlist-id"),this.playerId=this.playlistId?"player-"+this.videoContainer.data("playlist-id"):"player",this.videoIframe=this.videoContainer.find("#"+this.playerId),this.navButtons=this.videoContainer.find(".nav-button"),this.previousButton=this.videoContainer.find(".previous"),this.nextButton=this.videoContainer.find(".next"),this.thumbnails=this.videoContainer.find(".playlist-list li"),this.previews=this.videoContainer.find(".playlist-preview"),this.autoplay=e,this.autoload=s,this.popup=o,this.debug=a,this.layout=l,this.loop=n,this.firstPlay=!0,this.postId=this.videoContainer.data("post-id"),this.videoContainer.addClass(l),this.getVideoIds(),this.autoload?this.init():this.popup||this.bindInstantiateAction(),"single"===this.popup&&this.addPlayerPopup(),this.loop?this.previousButton.data("video-index",this.videoList.length-1):this.previousButton.data("video-index",0)}init(){this.consoleDebug("SCPlayer init()"),this.actionsBound||this.bindActions(),this.instantiated?this.onPlayerReady():this.instantiatePlayer()}addPlayerPopup(){const i=t("#"+this.playerId).prop("href");0===this.videoList.length&&i&&(this.singleVideo=!0,this.singleVideoUrl=i,this.singleVideoTitle=t("#"+this.playerId).data("video-title")),t("#"+this.playerId).prop("id","");const e="player-popup-"+this.postId,s=t("<div/>",{id:e,class:"mfp-hide player-popup single-popup",data:{"post-id":this.postId}}),a=t("<div/>",{class:"player-popup-inner"}),o=t("<div/>",{class:"mfp-iframe-scaler"}),n=t("<div/>",{id:this.playerId,data:{"video-index":this.startVideo}});s.append(a),a.append(o),this.previousButton.addClass("mfp-arrow mfp-arrow-left mfp-prevent-close"),this.nextButton.addClass("mfp-arrow mfp-arrow-right mfp-prevent-close"),s.append(this.navButtons),o.append(n),this.videoContainer.append(s);o.append('<div class="mfp-bottom-bar"><div class="mfp-title">...</div></div>');const l=this;this.previews.on("click",(function(i){i.preventDefault(),l.startVideo=t(this).data("video-index"),t.magnificPopup.open({items:{src:"#"+e},type:"inline",callbacks:{open(){window.players[this.content.data("post-id")].init()},close(){window.players[this.content.data("post-id")].close()}}})})),this.previews.on("keydown",(function(i){"Enter"!==i.code&&"Space"!==i.code&&13!==i.keyCode&&32!==i.keyCode&&13!==i.which&&32!==i.which||t(this).trigger("click")}))}instantiatePlayer(){this.consoleDebug("instantiatePlayer"),this.consoleDebug(this),this.player=new YT.Player(this.playerId,{height:"506.25",width:"900",events:{onReady:this.onPlayerReady.bind(this),onStateChange:this.onPlayerStateChange.bind(this)},playerVars:{controls:1,autoplay:this.autoplay,mute:0,playsinline:1,showinfo:0,rel:0,iv_load_policy:3,modestbranding:1}}),this.instantiated=!0,this.navButtons.show(),fitvids(".custom-api-playlist")}getVideoIds(){const i=[];this.thumbnails.each((function(){const e=t(this).find(".playlist-item-title").html(),s=t(this).data("video-id");i.push({title:e,id:s})})),this.videoList=i}onPlayerReady(){this.consoleDebug("onPlayerReady"),this.instantiated&&(this.singleVideo?(this.player.cueVideoByUrl(this.singleVideoUrl),this.setTitle(this.singleVideoTitle)):this.cueVideo(this.startVideo))}onPlayerStateChange(t){if(this.consoleDebug("event data: "+t.data),t.data===YT.PlayerState.PLAYING&&(this.consoleDebug("playing: "+this.playerId),e.pauseOtherVideos(this.playerId),this.navButtons.show(),this.firstPlay=!1),t.data===YT.PlayerState.CUED&&(this.consoleDebug("cued: "+this.playerId),this.consoleDebug("firstPlay: "+this.firstPlay+" /isActivePlayer: "+this.isActivePlayer+" /autoplay: "+this.autoplay),this.singleVideo||!this.firstPlay&&this.isActivePlayer||this.firstPlay&&this.autoplay?t.target.playVideo():this.consoleDebug("blocked cue")),t.data===YT.PlayerState.ENDED&&(this.consoleDebug("ended: "+this.playerId),this.isActivePlayer)){const t=this.videoIframe.data("video-index");t<this.videoList.length?(this.consoleDebug("play next video"),this.cueVideo(t+1)):t>=this.videoList.length&&this.loop&&(this.consoleDebug("loop back to end video"),this.cueVideo(this.videoList.length-1))}}updateNavIndex(t){t=parseInt(t),this.consoleDebug("updateNavIndex "+t);const i=t-1,e=t+1;i<0?this.loop?this.previousButton.data("video-index",this.videoList.length-1):(this.previousButton.addClass(this.inactiveButtonClass),this.previousButton.data("video-index","")):(this.previousButton.removeClass(this.inactiveButtonClass),this.previousButton.data("video-index",i)),e>=this.videoList.length?this.loop?this.nextButton.data("video-index",0):(this.nextButton.addClass(this.inactiveButtonClass),this.nextButton.data("video-index","")):(this.nextButton.removeClass(this.inactiveButtonClass),this.nextButton.data("video-index",e))}setTitle(i){if("single"===this.popup){i||(i="");t("#player-popup-"+this.postId).find(".mfp-title").html(i)}}cueVideo(t){this.consoleDebug("cueVideo"),this.consoleDebug(this.player),this.isActivePlayer=!0,t=parseInt(t),this.consoleDebug("cuevideo "+t),this.player.cueVideoById(this.videoList[t].id),this.videoIframe.data("video-index",t),this.updateNavIndex(t),this.setTitle(this.videoList[t].title)}bindActions(){this.consoleDebug("bind actions");const i=this;"single"!==this.popup&&this.thumbnails.on("click",(function(){const e=parseInt(t(this).data("video-index"));i.consoleDebug("clicked thumbnail index: "+e),i.firstPlay=!1,i.cueVideo(e)})),this.navButtons.on("click",(function(){const e=parseInt(t(this).data("video-index"));i.consoleDebug("clicked button index: "+e),isNaN(e)?i.consoleDebug("no navButton index"):i.cueVideo(e)})),this.actionsBound=!0}lazyLoadInstantiate(i){const e=i.data.SCPlayer;e.consoleDebug("lazyLoadInstantiate");const s=parseInt(t(this).data("video-index"));e.consoleDebug("set start video to: "+s),isNaN(s)?e.consoleDebug("no lazyLoad index"):(e.startVideo=s,e.bindActions(),e.autoplay=!0,e.instantiatePlayer(),e.previews.off("click",e.lazyLoadInstantiate),e.navButtons.off("click",e.lazyLoadInstantiate))}bindInstantiateAction(){this.previews.on("click",{SCPlayer:this},this.lazyLoadInstantiate),this.navButtons.on("click",{SCPlayer:this},this.lazyLoadInstantiate)}close(){this.consoleDebug("close popup"),this.player.destroy(),this.instantiated=!1}consoleDebug(t){this.debug&&console.log(t)}}class e{containersSelector;containers;defaultLayoutType="single-popup";layoutTypes=["single-popup","cover-popup","load-all","load-first","load-none"];layoutParameterSettings={"single-popup":{popup:"single",autoplay:!0,autoload:!1},"cover-popup":{popup:"full",autoplay:!0,autoload:!1},"load-all":{popup:!1,autoplay:!1,autoload:"all"},"load-first":{popup:!1,autoplay:!1,autoload:"first"},"load-none":{popup:!1,autoplay:!1,autoload:!1}};layoutParameters;constructor(i){this.containersSelector=i,this.containers=t(this.containersSelector),this.loadScript(),this.getLayoutType(),this.setupPlayers()}loadScript(){const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api";const i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(t,i)}getLayoutType(){if(this.layoutTypeElement=this.containers.parents(".video-layout-type"),this.layoutType=this.defaultLayoutType,this.layoutTypeElement.length){const t=this.layoutTypeElement.data("videolayout");this.layoutTypes.includes(t)&&(this.layoutType=t)}this.layoutParameters=this.layoutParameterSettings[this.layoutType],this.layoutParameters.layout=this.layoutType}setupPlayers(){const e=this;window.onYouTubePlayerAPIReady=function(){window.players=[];let s=0;e.containers.each((function(){s>0&&"load-all"!==this.layoutType&&(e.layoutParameters.autoload=!1);const a=new i(this,e.layoutParameters);window.players[t(this).data("post-id")]=a,s++}))}}static pauseOtherVideos(t){window.players.forEach((function(i){i.playerId!==t&&(i.isActivePlayer=!1,i.player&&1===i.player.getPlayerState()&&i.player.stopVideo())}))}}playlists=new e(".custom-api-playlist")}}(jQuery);